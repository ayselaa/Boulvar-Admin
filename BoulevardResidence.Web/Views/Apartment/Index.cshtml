@model BoulevardResidence.Service.DTOs.Aparments.GetAllApartmentDto
@{
    ViewData["Title"] = "Index";
}

<!-- Main Start-->
<main>
    <section class="apartment-bg">
        <div class="container container-items">
            <div class="apartment-over-text">
                  @if (Model.LangCode=="en")
                {
                    <h1>APARTMENTS</h1>
                }
                else if (Model.LangCode=="az")
                {
                    <h1>MƏNZİLLER</h1>
                }
                else
                {
                    <h1>КВАРТИРЫ</h1>
                }
            </div>
            <div class="back-to-page">
                <a href="index.html">
                    <svg width="21" height="16" viewBox="0 0 21 16" fill="none" xmlns="http://www.w3.org/2000/svg">
                        <path d="M20 8H1M1 8L8.125 1M1 8L8.125 15" stroke="white" stroke-width="1.5" stroke-linecap="round"
                              stroke-linejoin="round" />
                    </svg>
                </a>
            </div>
        </div>
    </section>

    <section class="table-section">
        <div class="container flex-choose-aprt">
            <div class="select-group">

                <div class="dropdown-filter">
                    @if (Model.LangCode=="en")
                    {
                        <button class="dropdown-button" onclick="toggleDropdown(1)">

                            BUILDING
                            <i class="fa-solid fa-chevron-down"></i>
                        </button>
                    }
                    else if (Model.LangCode=="az")
                    {
                        <button class="dropdown-button" onclick="toggleDropdown(1)">

                            BİNA
                            <i class="fa-solid fa-chevron-down"></i>
                        </button>
                    }
                    else
                    {
                        <button class="dropdown-button" onclick="toggleDropdown(1)">

                            ЗДАНИЕ
                            <i class="fa-solid fa-chevron-down"></i>
                        </button>
                    }
                    <div class="dropdown-content-item" id="myDropdown1">
                        @foreach (var building in ViewBag.Buildings)
                        {
                            <div class="form-check p-form-chack">
                                <label class="custom-checkbox">
                                    <input type="checkbox">
                                    <span class="custom-checkmark">
                                        <svg xmlns="http://www.w3.org/2000/svg" width="12" height="12" viewBox="0 0 12 12" fill="none">
                                            <path d="M4.775 8.9998L1.925 6.1498L2.6375 5.4373L4.775 7.5748L9.3625 2.9873L10.075 3.6998L4.775 8.9998Z"
                                              fill="#16244A" />
                                        </svg>
                                    </span>
                                    @building
                                </label>
                            </div>
                        }

                    </div>
                </div>

                <div class="dropdown-filter">
                     @if (Model.LangCode == "en")
                    {
                        <button class="dropdown-button" onclick="toggleDropdown(2)">
                            FLOOR <i class="fa-solid fa-chevron-down"></i>
                        </button>
                    }
                    else if (Model.LangCode == "az")
                    {
                        <button class="dropdown-button" onclick="toggleDropdown(2)">
                            MƏRTƏBƏ <i class="fa-solid fa-chevron-down"></i>
                        </button>
                    }
                    else
                    {
                        <button class="dropdown-button" onclick="toggleDropdown(2)">
                           Этаж <i class="fa-solid fa-chevron-down"></i>
                        </button>
                    }
                    <div class="dropdown-content-item" id="myDropdown2">
                        @foreach (var floor in ViewBag.Floors)
                        {
                            <div class="form-check p-form-chack">
                                <label class="custom-checkbox">
                                    <input type="checkbox">
                                    <span class="custom-checkmark">
                                        <svg xmlns="http://www.w3.org/2000/svg" width="12" height="12" viewBox="0 0 12 12" fill="none">
                                            <path d="M4.775 8.9998L1.925 6.1498L2.6375 5.4373L4.775 7.5748L9.3625 2.9873L10.075 3.6998L4.775 8.9998Z"
                                              fill="#16244A" />
                                        </svg>
                                    </span>
                                    @floor
                                </label>
                            </div>
                        }

                    </div>
                </div>

                <div class="dropdown-filter">
                    @if (Model.LangCode == "en")
                    {
                        <button class="dropdown-button" onclick="toggleDropdown(3)">
                            ROOMS <i class="fa-solid fa-chevron-down"></i>
                        </button>
                    }
                    else if (Model.LangCode == "az")
                    {
                        <button class="dropdown-button" onclick="toggleDropdown(3)">
                            OTAQLAR <i class="fa-solid fa-chevron-down"></i>
                        </button>
                    }
                    else
                    {
                        <button class="dropdown-button" onclick="toggleDropdown(3)">
                            НОМЕРА <i class="fa-solid fa-chevron-down"></i>
                        </button>
                    }
                    <div class="dropdown-content-item" id="myDropdown3">
                        @foreach (var room in ViewBag.Rooms)
                        {
                            <div class="form-check p-form-chack">
                                <label class="custom-checkbox">
                                    <input type="checkbox">
                                    <span class="custom-checkmark">
                                        <svg xmlns="http://www.w3.org/2000/svg" width="12" height="12" viewBox="0 0 12 12" fill="none">
                                            <path d="M4.775 8.9998L1.925 6.1498L2.6375 5.4373L4.775 7.5748L9.3625 2.9873L10.075 3.6998L4.775 8.9998Z"
                                              fill="#16244A" />
                                        </svg>
                                    </span>
                                    @room Room
                                </label>
                            </div>
                        }
                    </div>
                </div>

                <div class="dropdown-filter">
                     @if (Model.LangCode == "en")
                    {
                        <button class="dropdown-button" onclick="toggleDropdown(4)">
                            THE FLOOR AREA <i class="fa-solid fa-chevron-down"></i>
                        </button>
                    }
                    else if (Model.LangCode == "az")
                    {
                        <button class="dropdown-button" onclick="toggleDropdown(4)">
                            MƏRTƏBƏ SAHƏSİ <i class="fa-solid fa-chevron-down"></i>
                        </button>
                    }
                    else
                    {
                        <button class="dropdown-button" onclick="toggleDropdown(4)">
                            ПЛОЩАДЬ ПОЛА <i class="fa-solid fa-chevron-down"></i>
                        </button>
                    }
                    <div class="dropdown-content-item" id="myDropdown4">
                        <div class="filter-price">
                            <div class="filter-price__flex-row">
                                <div class="form-group" style="width: 50%;">
                                    <input class="filter-price__field js-price-down" type="text" min="0" max="@ViewBag.MaxFloorArea" value="@ViewBag.MinFloorArea" />
                                </div>
                                <div class="form-group" style="width: 50%; text-align: right;">
                                    <input class="filter-price__field js-price-up" type="text" min="0" max="@ViewBag.MaxFloorArea" value="@ViewBag.MaxFloorArea" />
                                </div>
                            </div>
                            <div class="filter-price__slider js-price-range"></div>
                        </div>

                        <br>
                        <div class="slider-controls-elements">
                            <button class="js-clear-sliders">
                                <svg width="22" height="22" viewBox="0 0 12 12" fill="none"
                                     xmlns="http://www.w3.org/2000/svg">
                                    <path d="M1.67375 3.4933C2.2817 2.44405 3.2502 1.65151 4.3991 1.26323C5.5479 0.87496 6.7986 0.91741 7.9185 1.38269C9.0383 1.84797 9.9509 2.70437 10.4863 3.7924C11.0217 4.8805 11.1434 6.126 10.8288 7.2972C10.5142 8.4683 9.7847 9.4852 8.7762 10.1585C7.7676 10.8318 6.5488 11.1156 5.3465 10.9571C4.1443 10.7986 3.0406 10.2086 2.241 9.2969C1.44138 8.3853 1.00034 7.2141 1 6.0014"
                                          stroke="#CFC273" stroke-linecap="round" stroke-linejoin="round" />
                                    <path d="M4.125 3.5015H1.625V1.00146" stroke="#CFC273" stroke-linecap="round"
                                          stroke-linejoin="round" />
                                </svg>
                            </button>
                            <button class="js-send-sliders">
                                <svg width="22" height="22" viewBox="0 0 11 8" fill="none" xmlns="http://www.w3.org/2000/svg">
                                    <path d="M10.3536 4.03558C10.5488 3.84028 10.5488 3.52368 10.3536 3.32838L7.1716 0.146453C6.9763 -0.0488175 6.6597 -0.0488175 6.4645 0.146453C6.2692 0.341713 6.2692 0.658293 6.4645 0.853583L9.2929 3.68198L6.4645 6.51038C6.2692 6.70568 6.2692 7.02228 6.4645 7.21748C6.6597 7.41278 6.9763 7.41278 7.1716 7.21748L10.3536 4.03558ZM0 4.18198H10V3.18198H0V4.18198Z" fill="white" />
                                </svg>
                            </button>


                        </div>
                    </div>
                </div>

                <div class="dropdown-filter">
                     @if (Model.LangCode == "en")
                    {
                        <button class="dropdown-button" onclick="toggleDropdown(5)">
                            FEATURES <i class="fa-solid fa-chevron-down"></i>
                        </button>
                    }
                    else if (Model.LangCode == "az")
                    {
                        <button class="dropdown-button" onclick="toggleDropdown(5)">
                            XÜSUSİYYƏTLƏRİ <i class="fa-solid fa-chevron-down"></i>
                        </button>
                    }
                    else
                    {
                        <button class="dropdown-button" onclick="toggleDropdown(5)">
                            ФУНКЦИИ <i class="fa-solid fa-chevron-down"></i>
                        </button>
                    }
                    <div class="dropdown-content-item" id="myDropdown5">
                        @foreach (var apartment in Model.Apartments)
                        {
                            @foreach (var feature in apartment.ApartmentFeatures)
                            {

                                <div class="form-check p-form-chack">
                                    <label class="custom-checkbox">
                                        <input type="checkbox">
                                        <span class="custom-checkmark">
                                            <svg xmlns="http://www.w3.org/2000/svg" width="12" height="12" viewBox="0 0 12 12" fill="none">
                                                <path d="M4.775 8.9998L1.925 6.1498L2.6375 5.4373L4.775 7.5748L9.3625 2.9873L10.075 3.6998L4.775 8.9998Z"
                                              fill="#16244A" />
                                            </svg>
                                        </span>
                                        @foreach (var item in feature.Feature.FeatureTranslates)
                                        {
                                            @item.Name
                                        }

                                    </label>
                                </div>

                            }
                        }

                    </div>
                </div>

            </div>
            <div class="apartments-found-filter">
                @if (Model.LangCode == "en")
                {
                    <p>@Model.Apartments.Count APARTMENTS FOUND</p>
                    <a href="#"><i class="fa-solid fa-arrow-rotate-left"></i>RESET FILTER</a>
                }
                else if (Model.LangCode == "az")
                {
                    <p>@Model.Apartments.Count MƏNZİL TAPILDI</p>
                    <a href="#"><i class="fa-solid fa-arrow-rotate-left"></i>FİLTRİ SIFIRLA</a>
                }
                else
                {
                    <p>@Model.Apartments.Count НАЙДЕНЫ КВАРТИРЫ</p>
                    <a href="#"><i class="fa-solid fa-arrow-rotate-left"></i>СБРОСИТЬ ФИЛЬТР</a>
                }
            </div>
            <div class="table-container">
                @foreach (var item in Model.Apartments)
                {
                    @if(Model.LangCode == "en")
                    {
                         <a class="tb-item" asp-controller="Apartment" asp-action="ApartmentDetail" asp-route-id="@item.Id">
                        <div class="table-item-info">
                            <div class="table-item-img">
                                <img src="~/apartmentplangallery/@item.ApartmentPlan" alt="img">
                            </div>
                            <div class="table-item-floor">
                                <p>@item.SectionName</p>
                                 <span>@item.Floor Floor</span>
                                 
                            </div>
                            <div class="table-item-rooms">
                                <span>@item.RoomsAmount Rooms</span>
                            </div>
                            <div class="table-item-area">
                                <span>@item.AreaTotal M &#178;</span>
                            </div>
                            <div class="table-item-features">
                                @foreach (var feat in item.ApartmentFeatures)
                                {
                                    @foreach (var items in feat.Feature.FeatureTranslates)
                                    {
                                        <div class="img-fet">
                                            <img src="~/featurelogo/@feat.Feature.Logo" alt="img">
                                            <div class="tooltip-sea">@items.Name</div>
                                        </div>
                                    }

                                }

                            </div>
                        </div>
                        </a>
                    }
                    else if(Model.LangCode == "az")
                    {
                         <a class="tb-item" asp-controller="Apartment" asp-action="ApartmentDetail" asp-route-id="@item.Id">
                        <div class="table-item-info">
                            <div class="table-item-img">
                                <img src="~/apartmentplangallery/@item.ApartmentPlan" alt="img">
                            </div>
                            <div class="table-item-floor">
                                <p>@item.SectionName</p>
                                <span>@item.Floor Mərtəbə</span>
                            </div>
                            <div class="table-item-rooms">
                                <span>@item.RoomsAmount Otaq</span>
                            </div>
                            <div class="table-item-area">
                                <span>@item.AreaTotal M &#178;</span>
                            </div>
                            <div class="table-item-features">
                                @foreach (var feat in item.ApartmentFeatures)
                                {
                                    @foreach (var items in feat.Feature.FeatureTranslates)
                                    {
                                        <div class="img-fet">
                                            <img src="~/featurelogo/@feat.Feature.Logo" alt="img">
                                            <div class="tooltip-sea">@items.Name</div>
                                        </div>
                                    }

                                }

                            </div>
                        </div>
                        </a>
                    }
                    else
                    {
                        <a class="tb-item" asp-controller="Apartment" asp-action="ApartmentDetail" asp-route-id="@item.Id">
                        <div class="table-item-info">
                            <div class="table-item-img">
                                <img src="~/apartmentplangallery/@item.ApartmentPlan" alt="img">
                            </div>
                            <div class="table-item-floor">
                                <p>@item.SectionName</p>
                                <span>@item.Floor Этаж</span>
                            </div>
                            <div class="table-item-rooms">
                                <span>@item.RoomsAmount Комната</span>
                            </div>
                            <div class="table-item-area">
                                <span>@item.AreaTotal M &#178;</span>
                            </div>
                            <div class="table-item-features">
                                @foreach (var feat in item.ApartmentFeatures)
                                {
                                    @foreach (var items in feat.Feature.FeatureTranslates)
                                    {
                                        <div class="img-fet">
                                            <img src="~/featurelogo/@feat.Feature.Logo" alt="img">
                                            <div class="tooltip-sea">@items.Name</div>
                                        </div>
                                    }

                                }

                            </div>
                        </div>
                        </a>
                    }

                }
            </div>
        </div>
    </section>

</main>
<!-- Main End-->
<script>
    //function filterApartments(building, floor, room, area) {
    //    console.log("Building: " + building);
    //    console.log("Floor: " + floor);
    //    console.log("Room: " + room);
    //    console.log("Floor Area: " + area);

    //    var data = {
    //        building: building,
    //        floor: floor,
    //        room: room,
    //        floorArea: area
    //    };

    //    console.log("Data to be sent:", data);

    //    $.ajax({
    //        url: "/Apartment/FilterApartments",
    //        type: "POST",
    //        data: data,
    //        success: function (result) {
    //            console.log("Success: ", result); // Handle the filtered results here
    //        },
    //        error: function (xhr, status, error) {
    //            console.log("Error: ", error); // Handle errors here
    //        }
    //    });
    //}

    //function filterApartments(room) {
    //    console.log("Room: " + room);

    //    var data = {
    //        room: room
    //    };

    //    console.log("Data to be sent:", data);

    //    $.ajax({
    //        url: "/Apartment/GetFilteredApartmentsAsync",
    //        type: "POST",
    //        data: data,
    //        success: function(result) {
    //            console.log("Success: ", result); // Filtrelenmiş sonuçları burada işleyin
    //        },
    //        error: function(xhr, status, error) {
    //            console.log("Error: ", error); // Hataları burada işleyin
    //        }
    //    });
    //}

    var building = $('#building').val();
    var floor = $('#floor').val();
    var room = $('#room').val();
    var area = $('#area').val();

    $.ajax({
        url: '/Apartment/FilterApartments', // Controller işlem yolunu belirtin
        type: 'POST',
        data: { building: building, floor: floor, room: room, area: area },
        success: function(data) {
            var table = $('#data-table tbody');
            table.empty(); // Mevcut verileri temizle
            // Verileri görsel olarak güncelleyin
            // Örnek: Tabloyu yeniden oluşturun veya güncelleyin
            data.forEach(function(item) {
                var row = $('<tr>');
                row.append($('<td>').text(item.Building));
                row.append($('<td>').text(item.Floor));
                row.append($('<td>').text(item.Room));
                row.append($('<td>').text(item.Area));
                //row.append($('<td>').text(item.Features));
                table.append(row);
            }
                });
</script>
